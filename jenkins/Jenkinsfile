pipeline {
    agent any

    // environment {
    //     DOCKER_HUB_CREDENTIALS=credentials('dockerhub')
    //     DOCKER_IMAGE=credentials('dockerimage')
    // }

    stages {
        stage('Build') {
            steps {
                // sh "mkdir app && cd app"
                
                sh """
                    pwd
                    docker run --user='jenkins' --rm -v `pwd`:/app -w /app apt-get update
                    docker run --user='jenkins' --rm -v `pwd`:/app -w /app apt-get upgrade
                    pip3 install --upgrade pip
                    
                """

                    // sudo apt-get update
                    // sudo apt-get upgrade
                // pip3 install --no-cache-dir -r requirements.txt 
                // sh """

                //     sudo docker build --no-cache -t $DOCKER_IMAGE .
                //     sudo docker login -u $DOCKER_HUB_CREDENTIALS_USR -p $DOCKER_HUB_CREDENTIALS_PSW
                //     sudo docker push $DOCKER_IMAGE
                //     sudo docker logout

                // """
            }
        }

        stage('Testing') {
            steps {
                echo 'Testing'
            }
        }
        
        stage('Deploy') {
            steps {
                echo 'Deploy'
            }
        }
    }
}
